"""
Translation module for the Medical Laboratory Management System
Supports English and Arabic languages
"""
import json

# Translation dictionary
TRANSLATIONS = {
    "en": {
        # General terms
        "Medical Laboratory Management System": "Medical Laboratory Management System",
        "Language:": "Language:",
        "Language Changed": "Language Changed",
        "Language changed to: {}": "Language changed to: {}",
        "Login": "Login",
        "Username:": "Username:",
        "Password:": "Password:",
        "Logout": "Logout",
        "Not logged in": "Not logged in",
        "Logged in as: {} ({})": "Logged in as: {} ({})",
        "Dashboard": "Dashboard",
        "Patients": "Patients",
        "Tests": "Tests",
        "Samples": "Samples",
        "Reports": "Reports",
        "Billing": "Billing",
        "Inventory": "Inventory",
        "Users": "Users",
        "Statistics": "Statistics",
        "Error": "Error",
        "Success": "Success",
        "Warning": "Warning",
        "Confirm Delete": "Confirm Delete",
        "Are you sure you want to delete this patient?": "Are you sure you want to delete this patient?",
        "Please enter both username and password": "Please enter both username and password",
        "Invalid username or password": "Invalid username or password",
        "Patient added successfully": "Patient added successfully",
        "Failed to add patient": "Failed to add patient",
        "Patient details would be shown here": "Patient details would be shown here",
        "Edit patient functionality would be implemented here": "Edit patient functionality would be implemented here",
        "Patient deleted successfully": "Patient deleted successfully",
        "Test added successfully": "Test added successfully",
        "Failed to add test": "Failed to add test",
        "Sample management functionality would be implemented here": "Sample management functionality would be implemented here",
        "Medical reports functionality would be implemented here": "Medical reports functionality would be implemented here",
        "Billing functionality would be implemented here": "Billing functionality would be implemented here",
        "Inventory management functionality would be implemented here": "Inventory management functionality would be implemented here",
        "User management functionality would be implemented here": "User management functionality would be implemented here",
        "Statistics and reports functionality would be implemented here": "Statistics and reports functionality would be implemented here",
        "Demo: admin / admin123": "Demo: admin / admin123",
        "Add Patient": "Add Patient",
        "Add Test": "Add Test",
        "View Details": "View Details",
        "Edit Patient": "Edit Patient",
        "Delete Patient": "Delete Patient",
        "Save": "Save",
        "Cancel": "Cancel",
        "Name:": "Name:",
        "Age:": "Age:",
        "Gender:": "Gender:",
        "Contact Info:": "Contact Info:",
        "Male": "Male",
        "Female": "Female",
        "Other": "Other",
        "Please enter patient name": "Please enter patient name",
        "Please enter a valid age": "Please enter a valid age",
        "Please select gender": "Please select gender",
        "Test Name:": "Test Name:",
        "Category:": "Category:",
        "Price:": "Price:",
        "Description:": "Description:",
        "Please enter test name": "Please enter test name",
        "Please enter category": "Please enter category",
        "Please enter a valid price": "Please enter a valid price",
        "Patients Management": "Patients Management",
        "Tests Management": "Tests Management",
        "Sample Management": "Sample Management",
        "Medical Reports": "Medical Reports",
        "Billing and Payments": "Billing and Payments",
        "Inventory Management": "Inventory Management",
        "User Management": "User Management",
        "Reports and Statistics": "Reports and Statistics",
        "ID": "ID",
        "Name": "Name",
        "Age": "Age",
        "Gender": "Gender",
        "Contact": "Contact",
        "Total Patients": "Total Patients",
        "Pending Tests": "Pending Tests",
        "Completed Today": "Completed Today",
        "Inventory Items": "Inventory Items",
        "Recent Activity": "Recent Activity",
        "Patient John Doe registered": "Patient John Doe registered",
        "Blood test requested for Jane Smith": "Blood test requested for Jane Smith",
        "X-Ray report signed by Dr. Johnson": "X-Ray report signed by Dr. Johnson",
        "Inventory item 'Reagent A' low stock alert": "Inventory item 'Reagent A' low stock alert",
        "Please select a patient": "Please select a patient",
        "Blood": "Blood",
        "Urine": "Urine",
        "Stool": "Stool",
        "Radiology": "Radiology",
        "Complete Blood Count": "Complete Blood Count",
        "Measures several components and features of blood": "Measures several components and features of blood",
        "Urinalysis": "Urinalysis",
        "Analysis of urine components": "Analysis of urine components",
        "Stool Analysis": "Stool Analysis",
        "Examination of stool sample": "Examination of stool sample",
        "X-Ray Chest": "X-Ray Chest",
        "Chest X-Ray imaging": "Chest X-Ray imaging",
        "Admin": "Admin",
        "Technician": "Technician",
        "Doctor": "Doctor",
        "Receptionist": "Receptionist",
        "Server": "Server",
        "Change Password": "Change Password",
        "Navigation": "Navigation",
        "Request Test": "Request Test",
        "View Test Requests": "View Test Requests",
        "Patient ID:": "Patient ID:",
        "Test Type:": "Test Type:",
        "Requested By:": "Requested By:",
        "Add Sample": "Add Sample",
        "Barcode:": "Barcode:",
        "Collected At:": "Collected At:",
        "Status:": "Status:",
        "View All Results": "View All Results",
        "Create New Result": "Create New Result",
        "Print Results": "Print Results",
        "Result ID": "Result ID",
        "Created At": "Created At",
        "Pending": "Pending",
        "Signed": "Signed",
        "Print": "Print",
        "Print Result": "Print Result",
        "Patient Information": "Patient Information",
        "Patient: {}": "Patient: {}",
        "Age: {}": "Age: {}",
        "Gender: {}": "Gender: {}",
        "Contact: {}": "Contact: {}",
        "N/A": "N/A",
        "Test Information": "Test Information",
        "Test: {}": "Test: {}",
        "Category: {}": "Category: {}",
        "Requested By: {}": "Requested By: {}",
        "Requested At: {}": "Requested At: {}",
        "Result Details": "Result Details",
        "Signed By: {}": "Signed By: {}",
        "Signed At: {}": "Signed At: {}",
        "Not signed yet": "Not signed yet",
        "Close": "Close",
        "In a real application, this would print the result.\n\nPatient: {}\nTest: {}\nResult: {}": "In a real application, this would print the result.\n\nPatient: {}\nTest: {}\nResult: {}",
        "Unknown Patient": "Unknown Patient",
        "Unknown Test": "Unknown Test",
        "Add Item": "Add Item",
        "Quantity:": "Quantity:",
        "Min Quantity:": "Min Quantity:",
        "Supplier:": "Supplier:",
        "Expiry Date (YYYY-MM-DD):": "Expiry Date (YYYY-MM-DD):",
        "Item Name:": "Item Name:",
        "Please enter item name": "Please enter item name",
        "Please enter a valid quantity": "Please enter a valid quantity",
        "Please enter a valid minimum quantity": "Please enter a valid minimum quantity",
        "Please enter a valid expiry date (YYYY-MM-DD)": "Please enter a valid expiry date (YYYY-MM-DD)",
        "Inventory item added successfully": "Inventory item added successfully",
        "View Item": "View Item",
        "Update Quantity": "Update Quantity",
        "Create Purchase Order": "Create Purchase Order",
        "Low Stock Alert": "Low Stock Alert",
        "Inventory item details would be shown here": "Inventory item details would be shown here",
        "Inventory quantity update functionality would be implemented here": "Inventory quantity update functionality would be implemented here",
        "Purchase order creation functionality would be implemented here": "Purchase order creation functionality would be implemented here",
        "Low stock alerts would be shown here": "Low stock alerts would be shown here",
        "Email:": "Email:",
        "Role:": "Role:",
        "Active:": "Active:",
        "Please enter email": "Please enter email",
        "Please enter password": "Please enter password",
        "Please select role": "Please select role",
        "User added successfully": "User added successfully",
        "User Details": "User Details",
        "User details would be shown here": "User details would be shown here",
        "Edit User": "Edit User",
        "User editing functionality would be implemented here": "User editing functionality would be implemented here",
        "Disable User": "Disable User",
        "User disabling functionality would be implemented here": "User disabling functionality would be implemented here",
        "From:": "From:",
        "To:": "To:",
        "Generate": "Generate",
        "Patient Statistics": "Patient Statistics",
        "Test Statistics": "Test Statistics",
        "Financial Statistics": "Financial Statistics",
        "Inventory Statistics": "Inventory Statistics",
        "Total Patients: 125": "Total Patients: 125",
        "New Patients (This Month): 15": "New Patients (This Month): 15",
        "Returning Patients: 85": "Returning Patients: 85",
        "Total Tests: 342": "Total Tests: 342",
        "Pending Tests: 24": "Pending Tests: 24",
        "Completed Tests: 318": "Completed Tests: 318",
        "Most Requested Test: Complete Blood Count": "Most Requested Test: Complete Blood Count",
        "Total Revenue: $12,540": "Total Revenue: $12,540",
        "Outstanding Payments: $1,240": "Outstanding Payments: $1,240",
        "Average Test Price: $36.67": "Average Test Price: $36.67",
        "Total Inventory Items: 42": "Total Inventory Items: 42",
        "Low Stock Items: 3": "Low Stock Items: 3",
        "Expiring Soon: 2": "Expiring Soon: 2",
        "Generate Statistics": "Generate Statistics",
        "Statistics generation functionality would be implemented here": "Statistics generation functionality would be implemented here",
        "Results Management": "Results Management",
        "View All Tests": "View All Tests",
        "Add New Test": "Add New Test",
        "Remove Selected": "Remove Selected",
        "Select Tests": "Select Tests",
        "Select": "Select",
        "Test Requests": "Test Requests",
        "Test Request ID": "Test Request ID",
        "Requested At": "Requested At",
        "Run Test": "Run Test",
        "Running test: {}": "Running test: {}"
    },
    "ar": {
        # General terms
        "Medical Laboratory Management System": "نظام إدارة مختبر طبي",
        "Language:": "اللغة:",
        "Language Changed": "تم تغيير اللغة",
        "Language changed to: {}": "تم تغيير اللغة إلى: {}",
        "Login": "تسجيل الدخول",
        "Username:": "اسم المستخدم:",
        "Password:": "كلمة المرور:",
        "Logout": "تسجيل الخروج",
        "Not logged in": "غير مسجل الدخول",
        "Logged in as: {} ({})": "مسجل الدخول كـ: {} ({})",
        "Dashboard": "لوحة التحكم",
        "Patients": "المرضى",
        "Tests": "الاختبارات",
        "Samples": "العينات",
        "Reports": "التقارير",
        "Billing": "الفوترة",
        "Inventory": "المخزون",
        "Users": "المستخدمون",
        "Statistics": "الإحصائيات",
        "Error": "خطأ",
        "Success": "نجاح",
        "Warning": "تحذير",
        "Confirm Delete": "تأكيد الحذف",
        "Are you sure you want to delete this patient?": "هل أنت متأكد من حذف هذا المريض؟",
        "Please enter both username and password": "الرجاء إدخال اسم المستخدم وكلمة المرور",
        "Invalid username or password": "اسم المستخدم أو كلمة المرور غير صحيحة",
        "Patient added successfully": "تمت إضافة المريض بنجاح",
        "Failed to add patient": "فشل في إضافة المريض",
        "Patient details would be shown here": "سيتم عرض تفاصيل المريض هنا",
        "Edit patient functionality would be implemented here": "سيتم تنفيذ وظيفة تعديل المريض هنا",
        "Patient deleted successfully": "تم حذف المريض بنجاح",
        "Test added successfully": "تمت إضافة الاختبار بنجاح",
        "Failed to add test": "فشل في إضافة الاختبار",
        "Sample management functionality would be implemented here": "سيتم تنفيذ وظيفة إدارة العينات هنا",
        "Medical reports functionality would be implemented here": "سيتم تنفيذ وظيفة التقارير الطبية هنا",
        "Billing functionality would be implemented here": "سيتم تنفيذ وظيفة الفوترة هنا",
        "Inventory management functionality would be implemented here": "سيتم تنفيذ وظيفة إدارة المخزون هنا",
        "User management functionality would be implemented here": "سيتم تنفيذ وظيفة إدارة المستخدمين هنا",
        "Statistics and reports functionality would be implemented here": "سيتم تنفيذ وظيفة الإحصائيات والتقارير هنا",
        "Demo: admin / admin123": "تجريبي: admin / admin123",
        "Add Patient": "إضافة مريض",
        "Add Test": "إضافة اختبار",
        "View Details": "عرض التفاصيل",
        "Edit Patient": "تعديل المريض",
        "Delete Patient": "حذف المريض",
        "Save": "حفظ",
        "Cancel": "إلغاء",
        "Name:": "الاسم:",
        "Age:": "العمر:",
        "Gender:": "الجنس:",
        "Contact Info:": "معلومات الاتصال:",
        "Male": "ذكر",
        "Female": "أنثى",
        "Other": "آخر",
        "Please enter patient name": "الرجاء إدخال اسم المريض",
        "Please enter a valid age": "الرجاء إدخال عمر صحيح",
        "Please select gender": "الرجاء اختيار الجنس",
        "Test Name:": "اسم الاختبار:",
        "Category:": "الفئة:",
        "Price:": "السعر:",
        "Description:": "الوصف:",
        "Please enter test name": "الرجاء إدخال اسم الاختبار",
        "Please enter category": "الرجاء إدخال الفئة",
        "Please enter a valid price": "الرجاء إدخال سعر صحيح",
        "Patients Management": "إدارة المرضى",
        "Tests Management": "إدارة الاختبارات",
        "Sample Management": "إدارة العينات",
        "Medical Reports": "التقارير الطبية",
        "Billing and Payments": "الفوترة والدفع",
        "Inventory Management": "إدارة المخزون",
        "User Management": "إدارة المستخدمين",
        "Reports and Statistics": "التقارير والإحصائيات",
        "ID": "المعرف",
        "Name": "الاسم",
        "Age": "العمر",
        "Gender": "الجنس",
        "Contact": "الاتصال",
        "Total Patients": "إجمالي المرضى",
        "Pending Tests": "الاختبارات المعلقة",
        "Completed Today": "مكتملة اليوم",
        "Inventory Items": "عناصر المخزون",
        "Recent Activity": "النشاط الأخير",
        "Patient John Doe registered": "تم تسجيل المريض جون دو",
        "Blood test requested for Jane Smith": "تم طلب تحليل دم لجاني سميث",
        "X-Ray report signed by Dr. Johnson": "تم توقيع تقرير الأشعة السينية من قبل الدكتور جونسون",
        "Inventory item 'Reagent A' low stock alert": "تنبيه نفاد مخزون 'الكائن A'",
        "Please select a patient": "الرجاء اختيار مريض",
        "Blood": "دم",
        "Urine": "بول",
        "Stool": "براز",
        "Radiology": "أشعة",
        "Complete Blood Count": "تحليل الدم الشامل",
        "Measures several components and features of blood": "يقيس عدة مكونات وخصائص للدم",
        "Urinalysis": "تحليل البول",
        "Analysis of urine components": "تحليل مكونات البول",
        "Stool Analysis": "تحليل البراز",
        "Examination of stool sample": "فحص عينة البراز",
        "X-Ray Chest": "أشعة الصدر",
        "Chest X-Ray imaging": "تصوير الأشعة السينية للصدر",
        "Admin": "مدير",
        "Technician": "فني",
        "Doctor": "طبيب",
        "Receptionist": "موظف استقبال",
        "Server": "الخادم",
        "Change Password": "تغيير كلمة المرور",
        "Navigation": "التنقل",
        "Request Test": "طلب اختبار",
        "View Test Requests": "عرض طلبات الاختبار",
        "Patient ID:": "معرف المريض:",
        "Test Type:": "نوع الاختبار:",
        "Requested By:": "مطلوب من قبل:",
        "Add Sample": "إضافة عينة",
        "Barcode:": "الباركود:",
        "Collected At:": "تم الجمع في:",
        "Status:": "الحالة:",
        "View All Results": "عرض جميع النتائج",
        "Create New Result": "إنشاء نتيجة جديدة",
        "Print Results": "طباعة النتائج",
        "Result ID": "معرف النتيجة",
        "Created At": "أنشئت في",
        "Pending": "معلقة",
        "Signed": "موقعة",
        "Print": "طباعة",
        "Print Result": "طباعة النتيجة",
        "Patient Information": "معلومات المريض",
        "Patient: {}": "المريض: {}",
        "Age: {}": "العمر: {}",
        "Gender: {}": "الجنس: {}",
        "Contact: {}": "الاتصال: {}",
        "N/A": "غير متوفر",
        "Test Information": "معلومات الاختبار",
        "Test: {}": "الاختبار: {}",
        "Category: {}": "الفئة: {}",
        "Requested By: {}": "مطلوب من قبل: {}",
        "Requested At: {}": "مطلوب في: {}",
        "Result Details": "تفاصيل النتيجة",
        "Signed By: {}": "وقعت من قبل: {}",
        "Signed At: {}": "وقعت في: {}",
        "Not signed yet": "لم توقع بعد",
        "Close": "إغلاق",
        "In a real application, this would print the result.\n\nPatient: {}\nTest: {}\nResult: {}": "في تطبيق حقيقي، سيتم طباعة النتيجة.\n\nالمريض: {}\nالاختبار: {}\nالنتيجة: {}",
        "Unknown Patient": "مريض غير معروف",
        "Unknown Test": "اختبار غير معروف",
        "Add Item": "إضافة عنصر",
        "Quantity:": "الكمية:",
        "Min Quantity:": "الحد الأدنى للكمية:",
        "Supplier:": "المورد:",
        "Expiry Date (YYYY-MM-DD):": "تاريخ الانتهاء (YYYY-MM-DD):",
        "Item Name:": "اسم العنصر:",
        "Please enter item name": "الرجاء إدخال اسم العنصر",
        "Please enter a valid quantity": "الرجاء إدخال كمية صحيحة",
        "Please enter a valid minimum quantity": "الرجاء إدخال الحد الأدنى للكمية الصحيحة",
        "Please enter a valid expiry date (YYYY-MM-DD)": "الرجاء إدخال تاريخ انتهاء صحيح (YYYY-MM-DD)",
        "Inventory item added successfully": "تمت إضافة عنصر المخزون بنجاح",
        "View Item": "عرض العنصر",
        "Update Quantity": "تحديث الكمية",
        "Create Purchase Order": "إنشاء أمر شراء",
        "Low Stock Alert": "تنبيه نفاد المخزون",
        "Inventory item details would be shown here": "سيتم عرض تفاصيل عنصر المخزون هنا",
        "Inventory quantity update functionality would be implemented here": "سيتم تنفيذ وظيفة تحديث كمية المخزون هنا",
        "Purchase order creation functionality would be implemented here": "سيتم تنفيذ وظيفة إنشاء أمر الشراء هنا",
        "Low stock alerts would be shown here": "سيتم عرض تنبيهات نفاد المخزون هنا",
        "Email:": "البريد الإلكتروني:",
        "Role:": "الدور:",
        "Active:": "نشط:",
        "Please enter email": "الرجاء إدخال البريد الإلكتروني",
        "Please enter password": "الرجاء إدخال كلمة المرور",
        "Please select role": "الرجاء اختيار الدور",
        "User added successfully": "تمت إضافة المستخدم بنجاح",
        "User Details": "تفاصيل المستخدم",
        "User details would be shown here": "سيتم عرض تفاصيل المستخدم هنا",
        "Edit User": "تعديل المستخدم",
        "User editing functionality would be implemented here": "سيتم تنفيذ وظيفة تعديل المستخدم هنا",
        "Disable User": "تعطيل المستخدم",
        "User disabling functionality would be implemented here": "سيتم تنفيذ وظيفة تعطيل المستخدم هنا",
        "From:": "من:",
        "To:": "إلى:",
        "Generate": "توليد",
        "Patient Statistics": "إحصائيات المرضى",
        "Test Statistics": "إحصائيات الاختبارات",
        "Financial Statistics": "الإحصائيات المالية",
        "Inventory Statistics": "إحصائيات المخزون",
        "Total Patients: 125": "إجمالي المرضى: 125",
        "New Patients (This Month): 15": "المرضى الجدد (هذا الشهر): 15",
        "Returning Patients: 85": "المرضى العائدون: 85",
        "Total Tests: 342": "إجمالي الاختبارات: 342",
        "Pending Tests: 24": "الاختبارات المعلقة: 24",
        "Completed Tests: 318": "الاختبارات المكتملة: 318",
        "Most Requested Test: Complete Blood Count": "الاختبار الأكثر طلبًا: تحليل الدم الشامل",
        "Total Revenue: $12,540": "إجمالي الإيرادات: $12,540",
        "Outstanding Payments: $1,240": "المدفوعات المستحقة: $1,240",
        "Average Test Price: $36.67": "متوسط سعر الاختبار: $36.67",
        "Total Inventory Items: 42": "إجمالي عناصر المخزون: 42",
        "Low Stock Items: 3": "عناصر نفاد المخزون: 3",
        "Expiring Soon: 2": "ستنتهي صلاحيتها قريبًا: 2",
        "Generate Statistics": "توليد الإحصائيات",
        "Statistics generation functionality would be implemented here": "سيتم تنفيذ وظيفة توليد الإحصائيات هنا",
        "Results Management": "إدارة النتائج",
        "View All Tests": "عرض جميع الاختبارات",
        "Add New Test": "إضافة اختبار جديد",
        "Remove Selected": "إزالة المحدد",
        "Select Tests": "تحديد الاختبارات",
        "Select": "تحديد",
        "Test Requests": "طلبات الاختبار",
        "Test Request ID": "معرف طلب الاختبار",
        "Requested At": "مطلوب في",
        "Run Test": "تشغيل الاختبار",
        "Running test: {}": "تشغيل الاختبار: {}"
    }
}

# Global variable to track current language
CURRENT_LANGUAGE = "en"

# Callback for language change notifications
LANGUAGE_CHANGE_CALLBACKS = []

def _(text):
    """
    Translate text to the current language
    """
    global CURRENT_LANGUAGE
    # Return translated text or original if not found
    return TRANSLATIONS.get(CURRENT_LANGUAGE, TRANSLATIONS["en"]).get(text, text)

def set_language(lang):
    """
    Set the current language and notify all callbacks
    """
    global CURRENT_LANGUAGE
    if lang in TRANSLATIONS:
        CURRENT_LANGUAGE = lang
        # Notify all registered callbacks
        for callback in LANGUAGE_CHANGE_CALLBACKS:
            try:
                callback()
            except Exception:
                pass  # Ignore errors in callbacks

def register_language_change_callback(callback):
    """
    Register a callback to be notified when language changes
    """
    global LANGUAGE_CHANGE_CALLBACKS
    if callback not in LANGUAGE_CHANGE_CALLBACKS:
        LANGUAGE_CHANGE_CALLBACKS.append(callback)

def unregister_language_change_callback(callback):
    """
    Unregister a callback from language change notifications
    """
    global LANGUAGE_CHANGE_CALLBACKS
    if callback in LANGUAGE_CHANGE_CALLBACKS:
        LANGUAGE_CHANGE_CALLBACKS.remove(callback)